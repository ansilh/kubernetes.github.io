<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.121.1"><meta name=generator content="Relearn 5.23.2+tip"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="Kubernetes pocket gude and more"><meta name=author content="Ansil H"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kubernetes.ansilh.com/images/hero.png"><meta name=twitter:title content="Inject data to Pod :: Hugo Relearn Theme"><meta name=twitter:description content="Kubernetes pocket gude and more"><meta property="og:title" content="Inject data to Pod :: Hugo Relearn Theme"><meta property="og:description" content="Kubernetes pocket gude and more"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.ansilh.com/08-multi_container_pod/01-env-inject/index.html"><meta property="og:image" content="https://kubernetes.ansilh.com/images/hero.png"><meta property="og:site_name" content="Hugo Relearn Theme"><title>Inject data to Pod :: Hugo Relearn Theme</title>
<link href=../../images/logo.svg?1704645833 rel=icon type=image/svg+xml><link href=../../css/fontawesome-all.min.css?1704645834 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1704645834 rel=stylesheet></noscript><link href=../../css/nucleus.css?1704645834 rel=stylesheet><link href=../../css/auto-complete.css?1704645834 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1704645834 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1704645834 rel=stylesheet><link href=../../css/fonts.css?1704645834 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1704645834 rel=stylesheet></noscript><link href=../../css/theme.css?1704645834 rel=stylesheet><link href=../../css/theme-neon.css?1704645834 rel=stylesheet id=R-variant-style><link href=../../css/chroma-neon.css?1704645834 rel=stylesheet id=R-variant-chroma-style><link href=../../css/variant.css?1704645834 rel=stylesheet><link href=../../css/print.css?1704645834 rel=stylesheet media=print><link href=../../css/format-print.css?1704645834 rel=stylesheet><link href=../../css/ie.css?1704645834 rel=stylesheet><script src=../../js/url.js?1704645834></script><script src=../../js/variant.js?1704645834></script><script>window.index_js_url="../../index.search.js";var root_url="../../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://kubernetes.ansilh.com/",window.relearn.themeVariantModifier="",window.variants&&variants.init(["neon"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><style>#R-body img.bg-white{background-color:#fff}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../08-multi_container_pod/01-env-inject/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../08-multi_container_pod/index.html><span itemprop=name>Multi-Container Pods</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Inject data to Pod</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=inject-data-to-pod>Inject data to Pod</h1><h3 id=inject-data-to-pod-via-environmental-variable>Inject data to pod via Environmental variable</h3><p>We will create a Coffee Pod</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl run tea --image<span class=o>=</span>ansilh/demo-tea --env<span class=o>=</span><span class=nv>MY_NODE_NAME</span><span class=o>=</span>scratch --restart<span class=o>=</span>Never --dry-run -o yaml &gt;pod-with-env.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>MY_NODE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>scratch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ansilh/demo-tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coffee-new</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>ClusterFirst</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{}</span></span></code></pre></div><p>Lets run this Pod</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl create -f pod-with-env.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pods
</span></span><span class=line><span class=cl>NAME         READY   STATUS              RESTARTS   AGE
</span></span><span class=line><span class=cl>tea          1/1     Running   <span class=m>0</span>          7s</span></span></code></pre></div><p>Lets expose the pod as <code>NodePort</code></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl expose pod tea --port<span class=o>=</span><span class=m>80</span> --target-port<span class=o>=</span><span class=m>8080</span> --type<span class=o>=</span>NodePort</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get svc tea
</span></span><span class=line><span class=cl>NAME   TYPE       CLUSTER-IP      EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>        AGE
</span></span><span class=line><span class=cl>tea    NodePort   192.168.10.37   &lt;none&gt;        80:32258/TCP   42s</span></span></code></pre></div><p>Access the service using browser uisng node IP and port <code>32258</code></p><p>You will see below in Page
<code>Node:scratch</code></p><h3 id=expose-pod-fields-to-containers>Expose Pod fields to containers</h3><p>Lets extract the <code>nodeName</code> from spec ( Excuse me ? yeah we will see that in a moment )</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>k8s@k8s-master-01:~$ kubectl get pods tea -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.spec.nodeName}&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span>
</span></span><span class=line><span class=cl>k8s-worker-01
</span></span><span class=line><span class=cl>k8s@k8s-master-01:~$ kubectl get pods tea -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.hostIP}&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span>
</span></span><span class=line><span class=cl>192.168.56.202
</span></span><span class=line><span class=cl>k8s@k8s-master-01:~$ kubectl get pods tea -o<span class=o>=</span><span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.podIP}&#39;</span> <span class=o>&amp;&amp;</span> <span class=nb>echo</span>
</span></span><span class=line><span class=cl>10.10.1.23
</span></span><span class=line><span class=cl>k8s@k8s-master-01:~$</span></span></code></pre></div><p>To get the JSON path , first we need to get the entire object output in JSON.
We have used output in <code>YAML</code> so far because its easy . But internally <code>kubectl</code> convers <code>YAML</code> to <code>JSON</code></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pod tea -o json</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;apiVersion&#34;: </span><span class=s2>&#34;v1&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;kind&#34;: </span><span class=s2>&#34;Pod&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;metadata&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;annotations&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;cni.projectcalico.org/podIP&#34;: </span><span class=s2>&#34;10.10.1.23/32&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;creationTimestamp&#34;: </span><span class=s2>&#34;2019-01-06T15:09:36Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;labels&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>&#34;run&#34;: </span><span class=s2>&#34;tea&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;tea&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;namespace&#34;: </span><span class=s2>&#34;default&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;resourceVersion&#34;: </span><span class=s2>&#34;218696&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;selfLink&#34;: </span><span class=s2>&#34;/api/v1/namespaces/default/pods/tea&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;uid&#34;: </span><span class=s2>&#34;14c1715b-11c5-11e9-9f0f-0800276a1bd2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;spec&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;containers&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;env&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;MY_NODE_NAME&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;value&#34;: </span><span class=s2>&#34;scratch&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;image&#34;: </span><span class=s2>&#34;ansilh/demo-tea&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;imagePullPolicy&#34;: </span><span class=s2>&#34;Always&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;coffee-new&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;resources&#34;: </span>{}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;terminationMessagePath&#34;: </span><span class=s2>&#34;/dev/termination-log&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;terminationMessagePolicy&#34;: </span><span class=s2>&#34;File&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;volumeMounts&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;mountPath&#34;: </span><span class=s2>&#34;/var/run/secrets/kubernetes.io/serviceaccount&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;default-token-72pzg&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;readOnly&#34;: </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;dnsPolicy&#34;: </span><span class=s2>&#34;ClusterFirst&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;enableServiceLinks&#34;: </span><span class=kc>true</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;nodeName&#34;: </span><span class=s2>&#34;k8s-worker-01&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;priority&#34;: </span><span class=m>0</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;restartPolicy&#34;: </span><span class=s2>&#34;Never&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;schedulerName&#34;: </span><span class=s2>&#34;default-scheduler&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;securityContext&#34;: </span>{}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;serviceAccount&#34;: </span><span class=s2>&#34;default&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;serviceAccountName&#34;: </span><span class=s2>&#34;default&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;terminationGracePeriodSeconds&#34;: </span><span class=m>30</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;tolerations&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;effect&#34;: </span><span class=s2>&#34;NoExecute&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;key&#34;: </span><span class=s2>&#34;node.kubernetes.io/not-ready&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;operator&#34;: </span><span class=s2>&#34;Exists&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;tolerationSeconds&#34;: </span><span class=m>300</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;effect&#34;: </span><span class=s2>&#34;NoExecute&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;key&#34;: </span><span class=s2>&#34;node.kubernetes.io/unreachable&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;operator&#34;: </span><span class=s2>&#34;Exists&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;tolerationSeconds&#34;: </span><span class=m>300</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;volumes&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;default-token-72pzg&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;secret&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>&#34;defaultMode&#34;: </span><span class=m>420</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>&#34;secretName&#34;: </span><span class=s2>&#34;default-token-72pzg&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;status&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;conditions&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastProbeTime&#34;: </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastTransitionTime&#34;: </span><span class=s2>&#34;2019-01-06T15:09:36Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;True&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;Initialized&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastProbeTime&#34;: </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastTransitionTime&#34;: </span><span class=s2>&#34;2019-01-06T15:09:42Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;True&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;Ready&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastProbeTime&#34;: </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastTransitionTime&#34;: </span><span class=s2>&#34;2019-01-06T15:09:42Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;True&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;ContainersReady&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastProbeTime&#34;: </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastTransitionTime&#34;: </span><span class=s2>&#34;2019-01-06T15:09:36Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;True&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;PodScheduled&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;containerStatuses&#34;: </span><span class=p>[</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;containerID&#34;: </span><span class=s2>&#34;docker://291a72e7fdab6a9f7afc47c640126cf596f5e071903b6a9055b44ef5bcb1c104&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;image&#34;: </span><span class=s2>&#34;ansilh/demo-tea:latest&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;imageID&#34;: </span><span class=s2>&#34;docker-pullable://ansilh/demo-tea@sha256:998d07a15151235132dae9781f587ea4d2822c62165778570145b0f659dda7bb&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;lastState&#34;: </span>{}<span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;coffee-new&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;ready&#34;: </span><span class=kc>true</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;restartCount&#34;: </span><span class=m>0</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>&#34;state&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>&#34;running&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=nt>&#34;startedAt&#34;: </span><span class=s2>&#34;2019-01-06T15:09:42Z&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;hostIP&#34;: </span><span class=s2>&#34;192.168.56.202&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;phase&#34;: </span><span class=s2>&#34;Running&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;podIP&#34;: </span><span class=s2>&#34;10.10.1.23&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;qosClass&#34;: </span><span class=s2>&#34;BestEffort&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>&#34;startTime&#34;: </span><span class=s2>&#34;2019-01-06T15:09:36Z&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>}</span></span></code></pre></div><p>Remove below from <code>pod-with-env.yaml</code></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>MY_NODE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>scratch</span></span></span></code></pre></div><p>Add below Pod spec</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>MY_NODE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>spec.nodeName</span></span></span></code></pre></div><p>Resulting Pod Yaml</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>MY_NODE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>spec.nodeName</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ansilh/demo-tea</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coffee-new</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dnsPolicy</span><span class=p>:</span><span class=w> </span><span class=l>ClusterFirst</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>restartPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{}</span></span></code></pre></div><p>Delete the running pod files</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl delete pod tea</span></span></code></pre></div><p>Create the pod with modified yaml file</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl create -f pod-with-env.yaml</span></span></code></pre></div><p>Make sure <code>endpoint</code> is up in <code>service</code></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get ep tea
</span></span><span class=line><span class=cl>NAME   ENDPOINTS         AGE
</span></span><span class=line><span class=cl>tea    10.10.1.26:8080   31m</span></span></code></pre></div><p>Refresh the browser page. This time you will see <code>Node:k8s-worker-01</code></p><p>Lets do a cleanup on <code>default</code> namespace.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl delete --all pods
</span></span><span class=line><span class=cl>$ kubectl delete --all services</span></span></code></pre></div><p>Now you know</p><ul><li>How to use export Objects in Yaml and Json format</li><li>How to access each fields using <code>jsonpath</code></li><li>How to inject environmental variables to <code>Pod</code></li><li>How to inject system generated fields to <code>Pod</code> using environmental variables</li></ul><footer class=footline></footer></article></div></main></div><script src=../../js/clipboard.min.js?1704645834 defer></script><script src=../../js/perfect-scrollbar.min.js?1704645834 defer></script><script src=../../js/theme.js?1704645834 defer></script></body></html>