<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.121.1"><meta name=generator content="Relearn 5.23.2+tip"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="Kubernetes pocket gude and more"><meta name=author content="Ansil H"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kubernetes.ansilh.com/images/hero.png"><meta name=twitter:title content="Expose services in Pod :: Hugo Relearn Theme"><meta name=twitter:description content="Kubernetes pocket gude and more"><meta property="og:title" content="Expose services in Pod :: Hugo Relearn Theme"><meta property="og:description" content="Kubernetes pocket gude and more"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.ansilh.com/07-services/01-expose-pod/index.html"><meta property="og:image" content="https://kubernetes.ansilh.com/images/hero.png"><meta property="og:site_name" content="Hugo Relearn Theme"><title>Expose services in Pod :: Hugo Relearn Theme</title>
<link href=../../images/favicon.png?1704656418 rel=icon type=image/png><link href=../../css/fontawesome-all.min.css?1704656421 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fontawesome-all.min.css?1704656421 rel=stylesheet></noscript><link href=../../css/nucleus.css?1704656421 rel=stylesheet><link href=../../css/auto-complete.css?1704656421 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/auto-complete.css?1704656421 rel=stylesheet></noscript><link href=../../css/perfect-scrollbar.min.css?1704656421 rel=stylesheet><link href=../../css/fonts.css?1704656421 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../css/fonts.css?1704656421 rel=stylesheet></noscript><link href=../../css/theme.css?1704656421 rel=stylesheet><link href=../../css/theme-neon.css?1704656421 rel=stylesheet id=R-variant-style><link href=../../css/chroma-neon.css?1704656421 rel=stylesheet id=R-variant-chroma-style><link href=../../css/variant.css?1704656421 rel=stylesheet><link href=../../css/print.css?1704656421 rel=stylesheet media=print><link href=../../css/format-print.css?1704656421 rel=stylesheet><link href=../../css/ie.css?1704656421 rel=stylesheet><script src=../../js/url.js?1704656421></script><script src=../../js/variant.js?1704656421></script><script>window.index_js_url="../../index.search.js";var root_url="../../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://kubernetes.ansilh.com/",window.relearn.themeVariantModifier="",window.variants&&variants.init(["neon"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><style>#R-body img.bg-white{background-color:#fff}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../07-services/01-expose-pod/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../07-services/index.html><span itemprop=name>Services</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Expose services in Pod</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=expose-services-in-pod>Expose services in Pod</h1><h3 id=service>Service</h3><p>A Coffee Pod running in cluster and its listening on port 9090 on Pod&rsquo;s IP.
How can we expose that service to external world so that users can access it ?</p><p><a href=#R-image-2f1f46b7f5365c10ee76f6b101e07770 class=lightbox-link><img src="../../07-services/01-expose-pod/pod-service.png?classess=shadow" alt=Pod class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f1f46b7f5365c10ee76f6b101e07770><img src="../../07-services/01-expose-pod/pod-service.png?classess=shadow" alt=Pod class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><p>We need to <code>expose</code> the service.</p><p>As we know , the Pod IP is not routable outside of the cluster.
So we need a mechanism to reach the host&rsquo;s port and then that traffic should be diverted to Pod&rsquo;s port.</p><p>Lets create a Pod Yaml first.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ vi coffe.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coffee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ansilh/demo-coffee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>coffee</span></span></span></code></pre></div><p>Create Yaml</p><div class="wrap-code highlight"><pre tabindex=0><code>$ kubectl create -f coffe.yaml</code></pre></div><p>Expose the Pod with below command</p><div class="wrap-code highlight"><pre tabindex=0><code>$ kubectl expose pod coffee --port=80 --target-port=9090  --type=NodePort</code></pre></div><p>This will create a <code>Service</code> object in kubernetes , which will map the Node&rsquo;s port 30836 to <code>Service</code> IP/Port 192.168.10.86:80</p><p>We can see the derails using <code>kubectl get service</code> command</p><div class="wrap-code highlight"><pre tabindex=0><code>$ kubectl get service
NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
coffee       NodePort    192.168.10.86    &lt;none&gt;        80:30391/TCP   6s
kubernetes   ClusterIP   192.168.10.1     &lt;none&gt;        443/TCP        26h</code></pre></div><p>We can also see that the port is listening and kube-proxy is the one listening on that port.</p><div class="wrap-code highlight"><pre tabindex=0><code>$ sudo netstat -tnlup |grep 30836
tcp6       0      0 :::30391                :::*                    LISTEN      2785/kube-proxy</code></pre></div><p>Now you can open browser and access the <code>Coffee</code> app using URL <code>http://192.168.56.201:30391</code></p><h2 id=ports-in-service-objects>Ports in Service Objects</h2><h3 id=nodeport>nodePort</h3><p>This setting makes the service visible outside the Kubernetes cluster by the node’s IP address and the port number declared in this property. The service also has to be of type NodePort (if this field isn’t specified, Kubernetes will allocate a node port automatically).</p><h3 id=port>port</h3><p>Expose the service on the specified port internally within the cluster. That is, the service becomes visible on this port, and will send requests made to this port to the pods selected by the service.</p><h3 id=targetport>targetPort</h3><p>This is the port on the pod that the request gets sent to. Your application needs to be listening for network requests on this port for the service to work.</p><footer class=footline></footer></article><script src=https://giscus.app/client.js data-repo=ansilh/kubernetes.github.io data-repo-id=R_kgDOLB2cOA data-category=Announcements data-category-id=DIC_kwDOLB2cOM4CcQpH data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></main></div><script src=../../js/clipboard.min.js?1704656421 defer></script><script src=../../js/perfect-scrollbar.min.js?1704656421 defer></script><script src=../../js/theme.js?1704656421 defer></script></body></html>