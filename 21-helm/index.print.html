<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.121.1"><meta name=generator content="Relearn 5.23.2+tip"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="Kubernetes pocket gude and more"><meta name=author content="Ansil H"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kubernetes.ansilh.com/images/hero.png"><meta name=twitter:title content="Helm :: Hugo Relearn Theme"><meta name=twitter:description content="Kubernetes pocket gude and more"><meta property="og:title" content="Helm :: Hugo Relearn Theme"><meta property="og:description" content="Kubernetes pocket gude and more"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.ansilh.com/21-helm/index.html"><meta property="og:image" content="https://kubernetes.ansilh.com/images/hero.png"><meta property="og:site_name" content="Hugo Relearn Theme"><title>Helm :: Hugo Relearn Theme</title>
<link href=../images/logo.svg?1704652404 rel=icon type=image/svg+xml><link href=../css/fontawesome-all.min.css?1704652408 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fontawesome-all.min.css?1704652408 rel=stylesheet></noscript><link href=../css/nucleus.css?1704652408 rel=stylesheet><link href=../css/auto-complete.css?1704652408 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/auto-complete.css?1704652408 rel=stylesheet></noscript><link href=../css/perfect-scrollbar.min.css?1704652408 rel=stylesheet><link href=../css/fonts.css?1704652408 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fonts.css?1704652408 rel=stylesheet></noscript><link href=../css/theme.css?1704652408 rel=stylesheet><link href=../css/theme-neon.css?1704652408 rel=stylesheet id=R-variant-style><link href=../css/chroma-neon.css?1704652408 rel=stylesheet id=R-variant-chroma-style><link href=../css/variant.css?1704652408 rel=stylesheet><link href=../css/print.css?1704652408 rel=stylesheet media=print><link href=../css/format-print.css?1704652408 rel=stylesheet><link href=../css/ie.css?1704652408 rel=stylesheet><script src=../js/url.js?1704652408></script><script src=../js/variant.js?1704652408></script><script>window.index_js_url="../index.search.js";var root_url="../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://kubernetes.ansilh.com/",window.relearn.themeVariantModifier="",window.variants&&variants.init(["neon"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><style>#R-body img.bg-white{background-color:#fff}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../21-helm/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Helm</span><meta itemprop=position content="1"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 21</div><h1 id=helm>Helm</h1><p><a href=#R-image-ace974f248cd4e99787aebb800bc58f5 class=lightbox-link><img src=../21-helm/helm.svg alt=helm class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ace974f248cd4e99787aebb800bc58f5><img src=../21-helm/helm.svg alt=helm class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><p>The package manager for kubernetes and much more..</p><p>Helm is the best way to find, share, and use software built for kubernetes.</p><p><b>Read this <a href=https://medium.com/virtuslab/think-twice-before-using-helm-25fbb18bc822 target=_blank>post</a> before adopting Helm</b></p><p><b>Also read <a href=https://github.com/helm/community/blob/master/helm-v3/000-helm-v3.md target=_blank>Helm 3</a> design proposal<b></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Helm</h1><article class=default><header class=headline></header><h1 id=installation>Installation</h1><h4 id=download-helm-binaries>Download Helm binaries</h4><ul><li>Go to <code>https://github.com/helm/helm/releases</code></li><li>Copy download location from <code>Installation and Upgrading</code> section.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ wget https://storage.googleapis.com/kubernetes-helm/helm-v2.13.0-linux-amd64.tar.gz</span></span></code></pre></div><h4 id=extract-tarball>Extract tarball</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ tar -xvf helm-v2.13.0-linux-amd64.tar.gz</span></span></code></pre></div><h4 id=configure-helm-client>Configure <code>Helm</code> client.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo mv linux-amd64/helm /usr/local/bin/helm
</span></span><span class=line><span class=cl>$ helm version</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>Client: &amp;version.Version{SemVer:&#34;v2.13.0&#34;, GitCommit:&#34;79d07943b03aea2b76c12644b4b54733bc5958d6&#34;, GitTreeState:&#34;clean&#34;}
Error: could not find tiller</code></pre></div><h4 id=helm-server-side-configuration---tiller>Helm Server side configuration - Tiller</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>cat &lt;&lt;EOF &gt;tiller-rbac.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tiller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>kube-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRoleBinding</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tiller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>roleRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class=l>rbac.authorization.k8s.io</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterRole</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cluster-admin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>subjects</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tiller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>kube-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>EOF</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl create -f tiller-rbac.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm init --service-account tiller</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>Creating /home/k8s/.helm
Creating /home/k8s/.helm/repository
Creating /home/k8s/.helm/repository/cache
Creating /home/k8s/.helm/repository/local
Creating /home/k8s/.helm/plugins
Creating /home/k8s/.helm/starters
Creating /home/k8s/.helm/cache/archive
Creating /home/k8s/.helm/repository/repositories.yaml
Adding stable repo with URL: https://kubernetes-charts.storage.googleapis.com
Adding local repo with URL: http://127.0.0.1:8879/charts
$HELM_HOME has been configured at /home/k8s/.helm.

Tiller (the Helm server-side component) has been installed into your Kubernetes Cluster.

Please note: by default, Tiller is deployed with an insecure &#39;allow unauthenticated users&#39; policy.
To prevent this, run `helm init` with the --tiller-tls-verify flag.
For more information on securing your installation see: https://docs.helm.sh/using_helm/#securing-your-helm-installation
Happy Helming!</code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pods -n kube-system <span class=p>|</span>grep tiller</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>tiller-deploy-5b7c66d59c-8t7pc               1/1     Running   0          36s</code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=a-minimal-package>A Minimal Package</h1><p>In this demo , we will create an Nginx deployment with one replica.
This demo is like more or less applying a deployment yaml . But in upcoming sessions we will see how we can leverage helm to customize the deployment without modifying yaml specs.</p><h4 id=create-a-demo-helm-nginx-pkg-package>Create a demo helm-nginx-pkg package</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mkdir helm-nginx-pkg</span></span></code></pre></div><ul><li>Create a <code>templates</code> directory.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mkdir helm-nginx-pkg/templates</span></span></code></pre></div><h4 id=create-a-deployment-yaml-inside-templates-diretory>Create a deployment yaml inside <code>templates</code> diretory.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl run nginx-deployment --image<span class=o>=</span>nginx:1.9.10 --dry-run -o yaml &gt;helm-nginx-pkg/templates/nginx-deployment.yaml</span></span></code></pre></div><h4 id=create-a-chartyaml-httpshelmshdocsdeveloping_chartsthe-chart-yaml-file>Create a Chart.yaml (<a href=https://helm.sh/docs/developing_charts/#the-chart-yaml-file target=_blank>https://helm.sh/docs/developing_charts/#the-chart-yaml-file</a>)</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>cat &lt;&lt;EOF &gt;helm-nginx-pkg/Chart.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Demo Helm chart to deploy Nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>maintainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Ansil H&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;ansilh@gmail.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://ansilh.com&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>EOF</span></span></span></code></pre></div><h4 id=inspect-the-chart-and-see-the-details-of-package><code>inspect</code> the chart and see the details of package.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm inspect chart ./helm-nginx-pkg/</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Demo Helm chart to deploy Nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>maintainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>ansilh@gmail.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Ansil H</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://ansilh.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span></span></span></code></pre></div><h4 id=dry-run-install-to-see-everything-works-or-not>Dry-run install to see everything works or not</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm install ./helm-nginx-pkg  --debug --dry-run</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>[debug] Created tunnel using local port</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;43945&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>[debug] SERVER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;127.0.0.1:43945&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>[debug] Original chart version</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>[debug] CHART PATH</span><span class=p>:</span><span class=w> </span><span class=l>/home/k8s/helm-nginx-pkg</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NAME</span><span class=p>:</span><span class=w>   </span><span class=l>alliterating-crab</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>REVISION</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RELEASED</span><span class=p>:</span><span class=w> </span><span class=l>Fri Mar 15 14:13:59 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>CHART</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment-1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>USER-SUPPLIED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>COMPUTED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>HOOKS</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>MANIFEST</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Source: nginx-deployment/templates/nginx-deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.9.10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{}</span></span></code></pre></div><h4 id=to-verify-nothing-is-created-as-part-of-dry-run>To verify nothing is created as part of dry-run</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm ls</span></span></code></pre></div><h4 id=install-package>Install package</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm install ./helm-nginx-pkg</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>NAME</span><span class=p>:</span><span class=w>   </span><span class=l>filled-toad</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>LAST DEPLOYED</span><span class=p>:</span><span class=w> </span><span class=l>Fri Mar 15 14:15:50 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NAMESPACE</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>STATUS</span><span class=p>:</span><span class=w> </span><span class=l>DEPLOYED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RESOURCES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME              READY  UP-TO-DATE  AVAILABLE  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment  0/1    0           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Pod(related)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                               READY  STATUS   RESTARTS  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment-64f767964b-qj9t9  0/1    Pending  0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>$ kubectl get pods</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                READY   STATUS    RESTARTS   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment-64f767964b-qj9t9   1/1     Running   0          16s</span></span></span></code></pre></div><h4 id=list-deployed-charts>List deployed charts</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm ls</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>NAME       	REVISION	UPDATED                 	STATUS  	CHART             	APP VERSION	NAMESPACE
</span></span></span><span class=line><span class=cl><span class=go>filled-toad	1       	Fri Mar 15 14:15:50 2019	DEPLOYED	nginx-deployment-1	           	default
</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pods</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-64f767964b-drfcc   1/1     Running   0          21s</code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=lint>Lint</h1><h4 id=linting>Linting</h4><p>Helm lint will help to correct and standardize the package format</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm lint ./helm-nginx-pkg/</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0><code>==&gt; Linting ./helm-nginx-pkg/
[ERROR] Chart.yaml: directory name (helm-nginx-pkg) and chart name (nginx-deployment) must be the same
[INFO] Chart.yaml: icon is recommended
[INFO] values.yaml: file does not exist

Error: 1 chart(s) linted, 1 chart(s) failed</code></pre></div><h4 id=lets-correct-the-errors>Lets correct the errors</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mv helm-nginx-pkg nginx-deployment</span></span></code></pre></div><ul><li>Add an icon path (we will see where its used later)</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>cat &lt;&lt;EOF &gt;&gt;nginx-deployment/Chart.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>icon</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://img.icons8.com/nolan/64/000000/linux.png&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>EOF</span></span></span></code></pre></div><ul><li>Create <code>values.yaml</code> (we will see the use of this file later)</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ touch nginx-deployment/values.yaml</span></span></code></pre></div><ul><li>Lint the package again</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm lint ./nginx-deployment</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>==&gt; Linting ./nginx-deployment
Lint OK

1 chart(s) linted, no failures</code></pre></div><p>This time we see a perfect &ldquo;OK&rdquo;</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=upgrade>Upgrade</h1><h1 id=deployment>Deployment</h1><h4 id=modify-values-file-with-below-content>Modify <code>values</code> file with below content</h4><div class="wrap-code highlight"><pre tabindex=0><code>cat &lt;&lt;EOF &gt;nginx-deployment/values.yaml
replicaCount: 2
image:
  repository: &#34;nginx&#34;
  tag: &#34;1.14&#34;
EOF</code></pre></div><h4 id=modify-deployment-template>Modify deployment template</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ vi nginx-deployment/templates/nginx-deployment.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Values.replicaCount }}</span><span class=w> </span><span class=c># &lt;-- This is value is referred from values.yaml `replicaCount` field</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span>{{<span class=w> </span><span class=l>.Values.image.repository }}:{{ .Values.image.tag }}</span><span class=w> </span><span class=c># &lt;-- this is self explanatory :)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{}</span></span></code></pre></div><h4 id=lint-the-chart-to-make-sure-everything-good>Lint the chart to make sure everything good.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm lint ./nginx-deployment/</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>==&gt; Linting ./nginx-deployment/
Lint OK

1 chart(s) linted, no failures</code></pre></div><ul><li>The <code>REVISION</code> is <code>1</code> as of now.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm ls</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>NAME</span>            <span class=s>REVISION        UPDATED                         STATUS          CHART                   APP VERSION     NAMESPACE</span>
</span></span><span class=line><span class=cl><span class=na>ungaged-possum</span>  <span class=s>1               Fri Mar 15 16:41:28 2019        DEPLOYED        nginx-deployment-1                      default</span></span></span></code></pre></div><h4 id=execute-a-dry-run>Execute a dry-run</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm upgrade ungaged-possum ./nginx-deployment/   --dry-run --debug</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>[debug] Created tunnel using local port</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;43533&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>[debug] SERVER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;127.0.0.1:43533&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>REVISION</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RELEASED</span><span class=p>:</span><span class=w> </span><span class=l>Fri Mar 15 18:17:19 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>CHART</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment-1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>USER-SUPPLIED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>COMPUTED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>image</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.14&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replicaCount</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>HOOKS</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>MANIFEST</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Source: nginx-deployment/templates/nginx-deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.14</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>Release &#34;ungaged-possum&#34; has been upgraded. Happy Helming!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>LAST DEPLOYED</span><span class=p>:</span><span class=w> </span><span class=l>Fri Mar 15 16:41:28 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NAMESPACE</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>STATUS</span><span class=p>:</span><span class=w> </span><span class=l>DEPLOYED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RESOURCES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME              READY  UP-TO-DATE  AVAILABLE  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment  1/1    1           1          95m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Pod(related)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                               READY  STATUS   RESTARTS  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment-64f767964b-drfcc  1/1    Running  0         95m</span></span></span></code></pre></div><h4 id=upgrade-package>Upgrade package</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm upgrade ungaged-possum ./nginx-deployment/</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>Release</span> <span class=s>&#34;ungaged-possum&#34; has been upgraded. Happy Helming!</span>
</span></span><span class=line><span class=cl><span class=na>LAST</span> <span class=s>DEPLOYED: Fri Mar 15 18:17:52 2019</span>
</span></span><span class=line><span class=cl><span class=na>NAMESPACE</span><span class=o>:</span> <span class=s>default</span>
</span></span><span class=line><span class=cl><span class=na>STATUS</span><span class=o>:</span> <span class=s>DEPLOYED</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>RESOURCES</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=na>=</span><span class=o>=</span><span class=s>&gt; v1/Deployment</span>
</span></span><span class=line><span class=cl><span class=na>NAME</span>              <span class=s>READY  UP-TO-DATE  AVAILABLE  AGE</span>
</span></span><span class=line><span class=cl><span class=na>nginx-deployment</span>  <span class=s>1/2    1           1          96m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=na>=</span><span class=o>=</span><span class=s>&gt; v1/Pod(related)</span>
</span></span><span class=line><span class=cl><span class=na>NAME</span>                               <span class=s>READY  STATUS   RESTARTS  AGE</span>
</span></span><span class=line><span class=cl><span class=na>nginx-deployment-64f767964b-drfcc</span>  <span class=s>1/1    Running  0         96m</span></span></span></code></pre></div><h4 id=verify-the-number-of-pods-after-upgarde>Verify the number of <code>Pods</code> after upgarde.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pods</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>NAME                               READY   STATUS    RESTARTS   AGE
nginx-deployment-d5d56dcf9-6cxvk   1/1     Running   0          7s
nginx-deployment-d5d56dcf9-8r868   1/1     Running   0          20s</code></pre></div><h4 id=verify-the-new-nginx-version>Verify the new Nginx version</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> nginx-deployment-d5d56dcf9-6cxvk -- nginx -v</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>nginx version: nginx/1.14.2</code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm ls</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>NAME            REVISION        UPDATED                         STATUS          CHART                   APP VERSION     NAMESPACE
ungaged-possum  2               Fri Mar 15 18:17:52 2019        DEPLOYED        nginx-deployment-1                      default</code></pre></div><h4 id=check-the-helm-upgrade-history>Check the helm upgrade history</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm <span class=nb>history</span> ungaged-possum</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0><code>REVISION        UPDATED                         STATUS          CHART                   DESCRIPTION
1               Fri Mar 15 16:41:28 2019        SUPERSEDED      nginx-deployment-1      Install complete
2               Fri Mar 15 18:17:52 2019        DEPLOYED        nginx-deployment-1      Upgrade complete</code></pre></div><h4 id=check-the-changes-happened-between-revisions>Check the changes happened between revisions</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sdiff &lt;<span class=o>(</span>helm get ungaged-possum --revision<span class=o>=</span>1<span class=o>)</span> &lt;<span class=o>(</span>helm get ungaged-possum --revision<span class=o>=</span>2<span class=o>)</span></span></span></code></pre></div><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p><b>Output on right hand side shows the changed values.<br><code>|</code> Indicates changes in line.<br><code>></code> Indicates inserted lines.</b></p></div></div><div class="wrap-code highlight"><pre tabindex=0><code>REVISION: 1                                                   | REVISION: 2
RELEASED: Fri Mar 15 16:41:28 2019                            | RELEASED: Fri Mar 15 18:17:52 2019
CHART: nginx-deployment-1                                       CHART: nginx-deployment-1
USER-SUPPLIED VALUES:                                           USER-SUPPLIED VALUES:
{}                                                              {}

COMPUTED VALUES:                                                COMPUTED VALUES:
{}                                                            | image:
                                                              &gt;   repository: nginx
                                                              &gt;   tag: &#34;1.14&#34;
                                                              &gt; replicaCount: 2

HOOKS:                                                          HOOKS:
MANIFEST:                                                       MANIFEST:

---                                                             ---
# Source: nginx-deployment/templates/nginx-deployment.yaml      # Source: nginx-deployment/templates/nginx-deployment.yaml
apiVersion: apps/v1                                             apiVersion: apps/v1
kind: Deployment                                                kind: Deployment
metadata:                                                       metadata:
  creationTimestamp: null                                         creationTimestamp: null
  labels:                                                         labels:
    run: nginx-deployment                                           run: nginx-deployment
  name: nginx-deployment                                          name: nginx-deployment
spec:                                                           spec:
  replicas: 1                                                 |   replicas: 2
  selector:                                                       selector:
    matchLabels:                                                    matchLabels:
      run: nginx-deployment                                           run: nginx-deployment
  strategy: {}                                                    strategy: {}
  template:                                                       template:
    metadata:                                                       metadata:
      creationTimestamp: null                                         creationTimestamp: null
      labels:                                                         labels:
        run: nginx-deployment                                           run: nginx-deployment
    spec:                                                           spec:
      containers:                                                     containers:
      - image: nginx:1.9.10                                   |       - image: nginx:1.14
        name: nginx-deployment                                          name: nginx-deployment
        resources: {}                                                   resources: {}
status: {}                                                      status: {}</code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=rollback>Rollback</h1><h4 id=list-revisions>List revisions</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm list</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>NAME            REVISION        UPDATED                         STATUS          CHART                   APP VERSION     NAMESPACE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>ungaged-possum  2               Fri Mar 15 18:17:52 2019        DEPLOYED        nginx-deployment-1                      default</span></span></span></code></pre></div><h4 id=rollback-to-revision-1>Rollback to revision 1</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm rollback ungaged-possum <span class=m>1</span></span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>Rollback was a success! Happy Helming!
</span></span></span></code></pre></div><h4 id=list-the-revision-after-rollback>List the revision after rollback</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm list</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>NAME            REVISION        UPDATED                         STATUS          CHART                   APP VERSION     NAMESPACE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>ungaged-possum  3               Sat Mar 16 10:14:47 2019        DEPLOYED        nginx-deployment-1                      default</span></span></span></code></pre></div><h4 id=verify-rollback>Verify rollback</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get pods</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>NAME                                READY   STATUS    RESTARTS   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>nginx-deployment-64f767964b-trx7h   1/1     Running   0          44s</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> nginx-deployment-64f767964b-trx7h -- nginx -v</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>nginx version</span><span class=p>:</span><span class=w> </span><span class=l>nginx/1.9.10</span></span></span></code></pre></div><h4 id=examine-the-changes-between-active-revision-and-previous-one>Examine the changes between active revision and previous one.</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sdiff &lt;<span class=o>(</span>helm get ungaged-possum --revision<span class=o>=</span>2<span class=o>)</span> &lt;<span class=o>(</span>helm get ungaged-possum --revision<span class=o>=</span>3<span class=o>)</span></span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>REVISION: 2                                                   | REVISION</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RELEASED: Fri Mar 15 18:17:52 2019                            | RELEASED</span><span class=p>:</span><span class=w> </span><span class=l>Sat Mar 16 10:14:47 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>CHART: nginx-deployment-1                                       CHART</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment-1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>USER-SUPPLIED VALUES</span><span class=p>:</span><span class=w>                                           </span><span class=nt>USER-SUPPLIED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>{}<span class=w>                                                              </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>COMPUTED VALUES</span><span class=p>:</span><span class=w>                                                </span><span class=nt>COMPUTED VALUES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>image</span><span class=p>:</span><span class=w>                                                        </span><span class=l>| {}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class=l>nginx                                           &lt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1.14&#34;</span><span class=w>                                                 </span><span class=l>&lt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replicaCount</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>                                               </span><span class=l>&lt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>HOOKS</span><span class=p>:</span><span class=w>                                                          </span><span class=nt>HOOKS</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>MANIFEST</span><span class=p>:</span><span class=w>                                                       </span><span class=nt>MANIFEST</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>                                                             </span>---<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Source: nginx-deployment/templates/nginx-deployment.yaml      # Source: nginx-deployment/templates/nginx-deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion: apps/v1                                             apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind: Deployment                                                kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>                                                       </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp: null                                         creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>                                                         </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run: nginx-deployment                                           run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name: nginx-deployment                                          name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>                                                           </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas: 2                                                 |   replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>                                                       </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>                                                    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run: nginx-deployment                                           run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span>{<span class=nt>}                                                    strategy</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>                                                       </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>                                                       </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp: null                                         creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>                                                         </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run: nginx-deployment                                           run</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>                                                           </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>                                                     </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image: nginx:1.14                                     |       - image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.9.10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name: nginx-deployment                                          name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w> </span>{<span class=nt>}                                                   resources</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w> </span>{<span class=nt>}                                                      status</span><span class=p>:</span><span class=w> </span>{}</span></span></code></pre></div><p>In earlier sections , we have notices that there is no change in chart.
Its recommended to change the chart version based on the changes you make</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ vi nginx-deployment/Chart.yaml</span></span></code></pre></div><p>Change revision from 1 to 2</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=helm-create>Helm Create</h1><p>With <code>create</code> command , we can create a standard helm directory/file structure which can be modified for our package.</p><div class="wrap-code highlight"><pre tabindex=0><code>$ helm create mychart</code></pre></div><div class="wrap-code highlight"><pre tabindex=0><code>$ tree mychart/</code></pre></div><div class="wrap-code highlight"><pre tabindex=0><code>mychart/
 Chart.yaml         # A YAML file containing information about the chart.
 charts             # A directory containing any charts upon which this chart depends.
 templates          # A directory of templates that, when combined with values, will generate valid Kubernetes manifest files.
  NOTES.txt      # A plain text file containing short usage notes.
  _helpers.tpl   # Also called &#34;partials&#34; that can be embedded into existing files while a Chart is being installed.
  deployment.yaml # A deployment spec
  ingress.yaml    # An ingress spec
  service.yaml    # An service spec
  tests  
      test-connection.yaml # A pod definition , that can be executed to test the Chart(https://github.com/helm/helm/blob/master/docs/chart_tests.md)
 values.yaml         # The default configuration values for this chart

3 directories, 8 files</code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=kubeapps>Kubeapps</h1><p>Kubeapps is a web-based UI for deploying and managing applications in Kubernetes clusters</p><h4 id=kubeapps-installation>Kubeapps Installation</h4><ul><li>List present repos</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm repo list</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>NAME    URL
</span></span></span><span class=line><span class=cl><span class=go>stable  https://kubernetes-charts.storage.googleapis.com
</span></span></span><span class=line><span class=cl><span class=go>local   http://127.0.0.1:8879/charts
</span></span></span></code></pre></div><ul><li>Add bitnami repo</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm repo add bitnami https://charts.bitnami.com/bitnami</span></span></code></pre></div><p>&ldquo;bitnami&rdquo; has been added to your repositories</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm repo list</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>NAME</span>    <span class=s>URL</span>
</span></span><span class=line><span class=cl><span class=na>stable</span>  <span class=s>https://kubernetes-charts.storage.googleapis.com</span>
</span></span><span class=line><span class=cl><span class=na>local</span>   <span class=s>http://127.0.0.1:8879/charts</span>
</span></span><span class=line><span class=cl><span class=na>bitnami</span> <span class=s>https://charts.bitnami.com/bitnami</span></span></span></code></pre></div><ul><li>Install Kubeapps</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm install --name kubeapps --namespace kubeapps bitnami/kubeapps</span></span></code></pre></div><p>If it fails with below error , execute install one more time</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>Error: unable to recognize &#34;&#34;: no matches for kind &#34;AppRepository&#34; in version &#34;kubeapps.com/v1alpha1&#34;
</span></span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>NAME</span><span class=p>:</span><span class=w>   </span><span class=l>kubeapps</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>LAST DEPLOYED</span><span class=p>:</span><span class=w> </span><span class=l>Sat Mar 16 11:00:08 2019</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NAMESPACE</span><span class=p>:</span><span class=w> </span><span class=l>kubeapps</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>STATUS</span><span class=p>:</span><span class=w> </span><span class=l>DEPLOYED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>RESOURCES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                DATA  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-frontend-config            1     0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-dashboard-config  2     0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Pod(related)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                                         READY  STATUS             RESTARTS  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-6b59fbd4c5-8ggdr                                    0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-6b59fbd4c5-pbt4h                                    0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-apprepository-controller-59bff895fb-tjdtb  0/1    ContainerCreating  0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-chartsvc-5cc9c456fc-7r24x                  0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-chartsvc-5cc9c456fc-rzgzx                  0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-dashboard-6b54cd94fc-bm2st                 0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-dashboard-6b54cd94fc-zskq5                 0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy-d584c568c-spf8m               0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy-d584c568c-z2skv               0/1    Pending            0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-mongodb-8694b4b9f6-jqxw2                            0/1    ContainerCreating  0         0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                            TYPE       CLUSTER-IP       EXTERNAL-IP  PORT(S)    AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps                        ClusterIP  172.168.130.35   &lt;none&gt;       80/TCP     0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-chartsvc      ClusterIP  172.168.155.89   &lt;none&gt;       8080/TCP   0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-dashboard     ClusterIP  172.168.201.176  &lt;none&gt;       8080/TCP   0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy  ClusterIP  172.168.20.4     &lt;none&gt;       8080/TCP   0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-mongodb                ClusterIP  172.168.84.95    &lt;none&gt;       27017/TCP  0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1/ServiceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                        SECRETS  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-apprepository-controller  1        0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy              1        0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1beta1/Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME              READY  UP-TO-DATE  AVAILABLE  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-mongodb  0/1    1           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1beta1/Role</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                        AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-apprepository-controller  0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy              0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-repositories-read                  0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-repositories-write                 0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1beta1/RoleBinding</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                        AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-apprepository-controller  0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy              0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>==&gt; v1beta2/Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                        READY  UP-TO-DATE  AVAILABLE  AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps                                    0/2    0           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-apprepository-controller  0/1    1           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-chartsvc                  0/2    0           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-dashboard                 0/2    0           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>kubeapps-internal-tiller-proxy              0/2    0           0          0s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>NOTES</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cp>**</span><span class=w> </span><span class=l>Please be patient while the chart is being deployed **</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Tip</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>Watch the deployment status using the command</span><span class=p>:</span><span class=w> </span><span class=l>kubectl get pods -w --namespace kubeapps</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Kubeapps can be accessed via port 80 on the following DNS name from within your cluster</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=l>kubeapps.kubeapps.svc.cluster.local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>To access Kubeapps from outside your K8s cluster, follow the steps below</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>1. Get the Kubeapps URL by running these commands</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=l>echo &#34;Kubeapps URL: http://127.0.0.1:8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=l>export POD_NAME=$(kubectl get pods --namespace kubeapps -l &#34;app=kubeapps&#34; -o jsonpath=&#34;{.items[0].metadata.name}&#34;)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=l>kubectl port-forward --namespace kubeapps $POD_NAME 8080:8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=m>2</span><span class=l>. Open a browser and access Kubeapps using the obtained URL.</span></span></span></code></pre></div><ul><li>Make sure everything is no failed objects in <code>kubeapps</code> namespace.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get all --namespace<span class=o>=</span>kubeapps</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>NAME                                                              READY   STATUS      RESTARTS   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/apprepo-sync-bitnami-9f266-6ds4l                              0/1     Completed   0          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/apprepo-sync-incubator-p6fjk-q7hv2                            0/1     Completed   0          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/apprepo-sync-stable-79l58-mqrmg                               1/1     Running     0          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/apprepo-sync-svc-cat-725kn-kxvg6                              0/1     Completed   0          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-6b59fbd4c5-8ggdr                                     1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-6b59fbd4c5-pbt4h                                     1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-apprepository-controller-59bff895fb-tjdtb   1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-chartsvc-5cc9c456fc-7r24x                   1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-chartsvc-5cc9c456fc-rzgzx                   1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-dashboard-6b54cd94fc-bm2st                  1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-dashboard-6b54cd94fc-zskq5                  1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-tiller-proxy-d584c568c-spf8m                1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-internal-tiller-proxy-d584c568c-z2skv                1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pod/kubeapps-mongodb-8694b4b9f6-jqxw2                             1/1     Running     0          2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                     TYPE        CLUSTER-IP        EXTERNAL-IP   PORT(S)     AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>service/kubeapps                         ClusterIP   172.168.130.35    &lt;none&gt;        80/TCP      2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>service/kubeapps-internal-chartsvc       ClusterIP   172.168.155.89    &lt;none&gt;        8080/TCP    2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>service/kubeapps-internal-dashboard      ClusterIP   172.168.201.176   &lt;none&gt;        8080/TCP    2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>service/kubeapps-internal-tiller-proxy   ClusterIP   172.168.20.4      &lt;none&gt;        8080/TCP    2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>service/kubeapps-mongodb                 ClusterIP   172.168.84.95     &lt;none&gt;        27017/TCP   2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                                         READY   UP-TO-DATE   AVAILABLE   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps                                     2/2     2            2           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps-internal-apprepository-controller   1/1     1            1           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps-internal-chartsvc                   2/2     2            2           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps-internal-dashboard                  2/2     2            2           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps-internal-tiller-proxy               2/2     2            2           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>deployment.apps/kubeapps-mongodb                             1/1     1            1           2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                                                    DESIRED   CURRENT   READY   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-6b59fbd4c5                                     2         2         2       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-internal-apprepository-controller-59bff895fb   1         1         1       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-internal-chartsvc-5cc9c456fc                   2         2         2       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-internal-dashboard-6b54cd94fc                  2         2         2       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-internal-tiller-proxy-d584c568c                2         2         2       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>replicaset.apps/kubeapps-mongodb-8694b4b9f6                             1         1         1       2m15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                     COMPLETIONS   DURATION   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>job.batch/apprepo-sync-bitnami-9f266     1/1           53s        54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>job.batch/apprepo-sync-incubator-p6fjk   1/1           54s        54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>job.batch/apprepo-sync-stable-79l58      0/1           54s        54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>job.batch/apprepo-sync-svc-cat-725kn     1/1           13s        54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>NAME                                   SCHEDULE    SUSPEND   ACTIVE   LAST SCHEDULE   AGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>cronjob.batch/apprepo-sync-bitnami     0 * * * *   False     0        &lt;none&gt;          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>cronjob.batch/apprepo-sync-incubator   0 * * * *   False     0        &lt;none&gt;          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>cronjob.batch/apprepo-sync-stable      0 * * * *   False     0        &lt;none&gt;          54s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>cronjob.batch/apprepo-sync-svc-cat     0 * * * *   False     0        &lt;none&gt;          54s</span></span></span></code></pre></div><ul><li>Access Kubeapps dashboard
(My API server&rsquo;s insecure port is listening on 8080 port , so I had to use 8081 for port-forwarding)</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>export</span> <span class=nv>POD_NAME</span><span class=o>=</span><span class=k>$(</span>kubectl get pods --namespace kubeapps -l <span class=s2>&#34;app=kubeapps&#34;</span> -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&#34;{.items[0].metadata.name}&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>$ kubectl port-forward --namespace kubeapps <span class=nv>$POD_NAME</span> 8080:8081</span></span></code></pre></div><ul><li>Start an tunnel to 127.0.0.1:8081 using SSH via the host</li><li>Access Web GUI</li></ul><p><a href=#R-image-8a8e83d18a9a5f540d2e2d25be3911da class=lightbox-link><img src="../21-helm/07-kubeapp/login.jpg?classes=shadow" alt=Kubeapps class="figure-image bg-white border lightbox shadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a8e83d18a9a5f540d2e2d25be3911da><img src="../21-helm/07-kubeapp/login.jpg?classes=shadow" alt=Kubeapps class="lightbox-image bg-white border lightbox shadow" loading=lazy></a></p><ul><li>Create a service account for Kubeapps login</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl create serviceaccount kubeapps-operator
</span></span><span class=line><span class=cl>$ kubectl create clusterrolebinding kubeapps-operator --clusterrole<span class=o>=</span>cluster-admin --serviceaccount<span class=o>=</span>default:kubeapps-operator</span></span></code></pre></div><ul><li>Retrieve token</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get secret <span class=k>$(</span>kubectl get serviceaccount kubeapps-operator -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.secrets[].name}&#39;</span><span class=k>)</span> -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.data.token}&#39;</span> <span class=p>|</span> base64 --decode</span></span></code></pre></div><ul><li>Use this token to login</li></ul><p><a href=#R-image-7e024c846c3d40652676da8aee594dff class=lightbox-link><img src="../21-helm/07-kubeapp/after-login.jpg?classes=shadow" alt=KubeApps class="figure-image bg-white border lightbox shadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e024c846c3d40652676da8aee594dff><img src="../21-helm/07-kubeapp/after-login.jpg?classes=shadow" alt=KubeApps class="lightbox-image bg-white border lightbox shadow" loading=lazy></a></p><ul><li>Click on <code>Catalog</code> to see all Helm charts from upstream repositories.</li></ul><p><a href=#R-image-66ca2c9f2b38e70e80b5a20702c685ee class=lightbox-link><img src="../21-helm/07-kubeapp/catalog.jpg?classes=shadow" alt=Catalog class="figure-image bg-white border lightbox shadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-66ca2c9f2b38e70e80b5a20702c685ee><img src="../21-helm/07-kubeapp/catalog.jpg?classes=shadow" alt=Catalog class="lightbox-image bg-white border lightbox shadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=chartmuseum>ChartMuseum</h1><div><a href=https://chartmuseum.com target=_blank><img src=../21-helm/08-chart_museum/chartmuseum.svg style=display:block;margin-left:auto;margin-right:auto;width:10%></a></div>We can use ChartMuseum to host our own Helm packages.
In this session , we will configure ChartMuseum and will add the repository to Kubeapps<p>We will also upload the nginx-deployment helm package that we have created in earlier session to our local repository.</p><ul><li>Download and configure chartmuseum</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -LO https://s3.amazonaws.com/chartmuseum/release/latest/bin/linux/amd64/chartmuseum</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>We will be using <b>/{HOME}/chartstorage</b> directory to store the packages</p></div></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ chmod +x ./chartmuseum
</span></span><span class=line><span class=cl>$ sudo mv ./chartmuseum /usr/local/bin
</span></span><span class=line><span class=cl>$ mkdir ./chartstorage</span></span></code></pre></div><ul><li>Create a systemd service file.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>cat &lt;&lt;EOF | sudo tee /etc/systemd/system/chartmuseum.service
</span></span></span><span class=line><span class=cl><span class=go>[Unit]
</span></span></span><span class=line><span class=cl><span class=go>Description=Helm Chartmuseum
</span></span></span><span class=line><span class=cl><span class=go>Documentation=https://chartmuseum.com/
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[Service]
</span></span></span><span class=line><span class=cl><span class=go>ExecStart=/usr/local/bin/chartmuseum \\
</span></span></span><span class=line><span class=cl><span class=go> --debug \\
</span></span></span><span class=line><span class=cl><span class=go> --port=8090 \\
</span></span></span><span class=line><span class=cl><span class=go> --storage=&#34;local&#34; \\
</span></span></span><span class=line><span class=cl><span class=go> --storage-local-rootdir=&#34;/home/${USER}/chartstorage/&#34;
</span></span></span><span class=line><span class=cl><span class=go>Restart=on-failure
</span></span></span><span class=line><span class=cl><span class=go>RestartSec=5
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[Install]
</span></span></span><span class=line><span class=cl><span class=go>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=go>EOF
</span></span></span></code></pre></div><ul><li>Start chartmuseum</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>$ sudo systemctl start chartmuseum
</span></span><span class=line><span class=cl>$ sudo systemctl <span class=nb>enable</span> chartmuseum</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>Created symlink from /etc/systemd/system/multi-user.target.wants/chartmuseum.service to /etc/systemd/system/chartmuseum.service.
</span></span></span></code></pre></div><ul><li>Package our Helm chart</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>cd</span> nginx-deployment/
</span></span><span class=line><span class=cl>$ helm package .</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>Successfully packaged chart and saved it to: /home/ubuntu/nginx-deployment/nginx-deployment-2.tgz
</span></span></span></code></pre></div><ul><li>Upload package to ChartMuseum</li></ul><p>The URL IP is the IP of system which the chartmuseum service is running.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ curl -L --data-binary <span class=s2>&#34;@/home/ubuntu/nginx-deployment/nginx-deployment-2.tgz&#34;</span> 192.168.31.20:8090/api/charts</span></span></code></pre></div><ul><li>Also add the repository to helm</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ helm repo add chartmuseum http://192.168.31.20:8090</span></span></code></pre></div><ul><li>Add repo to Kubeapps</li></ul><p>Click <code>Configuration</code> -> <code>App Repositories</code> -> <code>Add App Repository</code></p><p>Fill <code>Name</code> and <code>URL</code> , then click <code>Install Repo</code></p><p><a href=#R-image-b3d9bd06fb62c79f6d9e8f21e324c8bb class=lightbox-link><img src=../21-helm/08-chart_museum/add-repo.jpg alt=repoadd class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b3d9bd06fb62c79f6d9e8f21e324c8bb><img src=../21-helm/08-chart_museum/add-repo.jpg alt=repoadd class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><ul><li>Repo will appear in the list after addition</li></ul><p><a href=#R-image-edde86d6a9a938e09dfdcb566a56b71b class=lightbox-link><img src=../21-helm/08-chart_museum/added-repo.jpg alt=repoadded class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-edde86d6a9a938e09dfdcb566a56b71b><img src=../21-helm/08-chart_museum/added-repo.jpg alt=repoadded class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><ul><li>View the Helm packages which is hosted in ChartMuseum</li></ul><p>Click <code>Catalog</code> and search <code>nginx-deployment</code></p><p>Remember , we have added an <code>icon</code> in our <code>Chart.yaml</code> file . You can see the same icon in deployment.</p><p><a href=#R-image-91ecf21de8aa5064367b34da9083ba1b class=lightbox-link><img src=../21-helm/08-chart_museum/demo-nginx.jpg alt=repochart class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-91ecf21de8aa5064367b34da9083ba1b><img src=../21-helm/08-chart_museum/demo-nginx.jpg alt=repochart class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=chartmuseum-ui>ChartMuseum UI</h1><p>Earlier we used <code>curl</code> command to upload our first helm package.
In this session , we will configure a UI for our local repository so that we can add/delete packages easily.</p><ul><li>Set <code>CHART_MUSESUM_URL</code> variable to the local repo URL.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>CHART_MUSESUM_URL</span><span class=o>=</span>http://192.168.31.20:8090</span></span></code></pre></div><ul><li>Create a deployment and service for UI.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>cat &lt;&lt;EOF &gt;chartmuseum-ui.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>LoadBalancer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>creationTimestamp</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>CHART_MUSESUM_URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>${CHART_MUSESUM_URL}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>idobry/chartmuseumui:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>chartmuseum-ui</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>EOF</span></span></span></code></pre></div><ul><li>Apply the spec to <code>kubeapps</code> namespace</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl create -f chartmuseum-ui.yaml --namespace<span class=o>=</span>kubeapps</span></span></code></pre></div><ul><li>Verify everything is in good state. (We may have to wait for few minutes while downloading the container image)</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ kubectl get all --namespace<span class=o>=</span>kubeapps <span class=p>|</span>grep chartmuseum-ui</span></span></code></pre></div><blockquote><p>Output</p></blockquote><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>pod/chartmuseum-ui-57b6d8f7dc-nbwwt                               1/1     Running     0          99s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>service/chartmuseum-ui                   LoadBalancer   172.168.85.102    192.168.31.202   80:30640/TCP   99s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>deployment.apps/chartmuseum-ui                               1/1     1            1           99s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>replicaset.apps/chartmuseum-ui-57b6d8f7dc                 
</span></span></span></code></pre></div><ul><li>Now we can access the UI using cluster IP and add or delete Helm packages to our local repository.</li></ul><p><a href=#R-image-99af15ea8e49d64dd725ccd1bc77d1c4 class=lightbox-link><img src=../21-helm/09-chartmuseum-ui/ui.jpg alt=ui class="figure-image bg-white border lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-99af15ea8e49d64dd725ccd1bc77d1c4><img src=../21-helm/09-chartmuseum-ui/ui.jpg alt=ui class="lightbox-image bg-white border lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section></div></main></div><script src=../js/clipboard.min.js?1704652409 defer></script><script src=../js/perfect-scrollbar.min.js?1704652409 defer></script><script src=../js/theme.js?1704652409 defer></script></body></html>